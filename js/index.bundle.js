document.addEventListener("DOMContentLoaded",(function(){const t=document.getElementById("add-modal"),e=document.getElementById("edit-modal"),n=document.getElementById("save-place"),c=document.getElementById("save-profile"),o=document.getElementById("place-name"),s=document.getElementById("place-url"),a=document.getElementById("name"),l=document.getElementById("job"),r=document.querySelector(".cards__wrapper"),i=document.querySelector(".icon--edit-button"),d=document.querySelector(".icon--add-button"),m=document.querySelectorAll(".close, .close-modal"),u=document.querySelector(".avatar-desc__title"),g=document.querySelector(".avatar-desc__sub-title"),v=[{name:"Карачаевск",imageUrl:"./img/cards/1.jpg"},{name:"Гора Эльбрус",imageUrl:"./img/cards/2.jpg"},{name:"Домбай",imageUrl:"./img/cards/3.jpg"}];function y(t,e){const n=document.createElement("div");n.classList.add("card"),n.innerHTML=`\n\t\t\t<img src="${e}" alt="${t}">\n\t\t\t<div class="title-wrapper">\n\t\t\t\t<h3 class="title">${t}</h3>\n\t\t\t\t<div class="like-wrapper">\n\t\t\t\t\t<svg class="icon icon--heart">\n\t\t\t\t\t\t<use href="./img/svgsprite/sprite.symbol.svg#heart"></use>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span class="like-count">0</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<svg class="icon icon--trash">\n\t\t\t\t<use href="./img/svgsprite/sprite.symbol.svg#trash"></use>\n\t\t\t</svg>\n\t\t`,n.querySelector(".icon--trash").addEventListener("click",(()=>{const c=t+e,o=JSON.parse(localStorage.getItem("likes"))||{};delete o[c],localStorage.setItem("likes",JSON.stringify(o)),n.remove(),E()}));const c=n.querySelector(".icon--heart"),o=n.querySelector(".like-count"),s=t+e,a=JSON.parse(localStorage.getItem("likes"))||{};return a[s]&&(o.textContent=a[s].count,a[s].isLiked&&c.classList.add("liked")),c.addEventListener("click",(()=>{let t=parseInt(o.textContent);const e=c.classList.toggle("liked");e?t+=1:t-=1,o.textContent=t;const n=JSON.parse(localStorage.getItem("likes"))||{};n[s]={count:t,isLiked:e},localStorage.setItem("likes",JSON.stringify(n))})),n}function p(t){t.style.display="flex",setTimeout((()=>t.classList.add("show")),10)}function S(t){t.classList.remove("show"),setTimeout((()=>{t.style.display="none"}),300)}function E(){const t=[];document.querySelectorAll(".card").forEach((e=>{const n=e.querySelector(".title").textContent,c=e.querySelector("img").src;t.push({name:n,imageUrl:c})})),localStorage.setItem("cards",JSON.stringify(t))}n.addEventListener("click",(function(e){e.preventDefault();const n=o.value.trim(),c=s.value.trim();if(n&&c){const e=y(n,c);r.prepend(e),E(),o.value="",s.value="",S(t)}})),document.body.addEventListener("click",(function(t){const e=t.target.closest(".icon--trash");if(e){const t=e.closest(".card");t&&(t.remove(),E())}})),i.addEventListener("click",(()=>{a.value=u.textContent,l.value=g.textContent,p(e)})),d.addEventListener("click",(()=>p(t))),m.forEach((t=>{t.addEventListener("click",(function(){S(this.closest(".modal"))}))})),window.addEventListener("click",(t=>{t.target.classList.contains("modal")&&S(t.target)})),document.addEventListener("keydown",(t=>{"Escape"===t.key&&document.querySelectorAll(".modal.show").forEach(S)})),c.addEventListener("click",(()=>{u.textContent=a.value,g.textContent=l.value,localStorage.setItem("profile",JSON.stringify({name:a.value,job:l.value})),S(e)})),function(){const t=JSON.parse(localStorage.getItem("profile"));t&&(u.textContent=t.name,g.textContent=t.job)}(),function(){const t=JSON.parse(localStorage.getItem("cards"));t&&0!==t.length?t.forEach((({name:t,imageUrl:e})=>{r.append(y(t,e))})):(v.forEach((({name:t,imageUrl:e})=>{r.append(y(t,e))})),E())}();const f=document.getElementById("image-modal"),k=document.getElementById("modal-image"),L=document.getElementById("modal-title");document.body.addEventListener("click",(t=>{const e=t.target.closest(".card img");if(e){const t=e.closest(".card").querySelector(".title").textContent;!function(t,e){k.src=t,k.alt=e,L.textContent=e,p(f)}(e.src,t)}})),f.querySelector(".close").addEventListener("click",(()=>{S(f)}))}));